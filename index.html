<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>HComP-Net</title>
  <link rel="stylesheet" href="css/main.css" />
  <link rel="icon" href="images/icons/favicon.ico" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Display:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
</head>

<body>
  <main>
    <div style="text-align: center">
      <details>
        <summary>More Research</summary>
        <div class="options">
          <p><a href="https://imageomics.github.io/bioclip/">BioCLIP</a></p>
          <p><a href="https://github.com/Imageomics/INTR">INTR</a></p>
          <p><a href="https://imageomics.github.io/phylo-diffusion/">Phylo-Diffusion/a></p>
          <p><a href="https://github.com/elhamod/phylonn">PhyloNN/a></p>
        </div>
      </details>
    </div>
    <h1>What Do You See in Common? Learning Hierarchical Prototypes over Tree-of-Life to Discover Evolutionary Traits</h1>
    <!-- <h2 style="text-align: center;">ECCV 2024</h2> -->
    <p class="centered">
      <sup>1</sup><a href="https://scholar.google.com/citations?user=tkA8j9QAAAAJ&hl=en">Harish Babu Manogaran</a>,
      <sup>1</sup><a href="https://people.cs.vt.edu/marufm/">M. Maruf</a>,
      <sup>6</sup><a href="https://scholar.google.com/citations?user=pz2Nm8AAAAAJ&hl=en">Arka Daw</a>,
      <sup>1</sup><a href="https://sajeedmehrab.github.io/">Kazi Sajeed Mehrab</a>,
      <sup>1</sup><a href="https://scholar.google.com/citations?user=LyaJ880AAAAJ&hl=en">Caleb Charpentier</a>,
      <sup>1</sup><a href="https://www.uyedalab.com/">Josef Uyeda</a>,
      <sup>2</sup><a href="https://www.faculty.uci.edu/profile/?facultyId=6769">Wasila Dahdul</a>,
      <sup>3</sup><a href="https://scholar.google.com/citations?user=S0Yx2ywAAAAJ&hl=en">Matthew J Thompson</a>,
      <sup>3</sup><a href="https://scholar.google.com/citations?user=GO6Y7SEAAAAJ&hl=en">Elizabeth G Campolongo</a>,
      <sup>3</sup><a href="https://scholar.google.com/citations?user=4juxrs8AAAAJ&hl=en">Kaiya L Provost</a>,
      <sup>4</sup><a href="https://scholar.google.com/citations?user=ZKnlvcoAAAAJ&hl=en">Paula Mabee</a>,
      <sup>5</sup><a href="https://scholars.duke.edu/person/Hilmar.Lapp">Hilmar Lapp</a>,
      <sup>1</sup><a href="https://people.cs.vt.edu/karpatne/">Anuj Karpatne</a>
    </p>
    <p class="centered">
      <sup>1</sup>Virginia Tech,
      <sup>2</sup>University of California, Irvine,
      <sup>3</sup>The Ohio State University,
      <sup>4</sup>Battelle,
      <sup>5</sup>Duke University,
      <sup>6</sup>Oak Ridge National Lab,
    </p>

    <p class="text-sm centered">
      <a href="mailto:harishbabu@vt.edu">harishbabu@vt.edu</a>, 
      <a href="mailto:karpatne@vt.edu">karpatne@vt.edu</a>
    </p>

<!--     <p class="centered"><strong>ECCV 2024.</strong></p> -->

    <p class="centered">
      <!-- <a class="pill-button" href="https://huggingface.co/datasets/imageomics/TreeOfLife-10M">
        <img src="images/icons/huggingface.svg" /> Data
      </a> -->
      <a class="pill-button" href="https://arxiv.org/abs/2409.02335">
        <img src="images/icons/arxiv.svg" /> Paper
      </a>
      <!-- <a class="pill-button" href="https://huggingface.co/spaces/mridulk/hier-embed">
        <img src="images/icons/huggingface.svg" /> Demo
      </a> -->
      <a class="pill-button" href="https://github.com/Imageomics/HComPNet">
        <img src="images/icons/github.svg" /> Code
      </a>

    </p>
    <figure style="text-align: center;">
      <img srcset="" src="images/new_teaser_5/new_teaser_5-1.png" alt="" loading="lazy">
      <figcaption>
        Figure 1: Sample images of bird species with zoomed-in views of learned prototypes <b>HComP-Net</b> along with their associated score maps. We consider the problem of finding evolutionary traits common to a group of species derived from the same ancestor (<span style="color:blue;">blue</span>) that are absent in the contrasting set of species from a different ancestor (<span style="color:red;">red</span>). We can infer that descendants of the blue node share a common trait: <em>long tail</em>, absent from descendants of the red node.
      </figcaption>
    </figure>

    <h2 class="banded">HComP-Net</h2>

    <p>
      We introduce an hierarchical interpretable image classification framework called <b>HComP-Net</b> that can be applied to discover potential evolutionary traits from images by making use of the Phylogenetic tree also called as Tree-Of-Life. HComP-Net idenitfies evolutionary traits by means of prototypes that are representative of the visual trait that is unique to a species or a group of species that share a common ancestor in the phylogeny. HComPNet can generate hypothesis for potential evolutionary traits by learning semantically meaningful non-over-specific prototypes at each internal node of the hierarchy.

      In order to discover evolutionary traits through prototypes, our approach features the following,

      <ul>
        <li><b>Hierarchical Prototypes</b> We learn prototypes at each internal node of the phylogeny such that each prototype captures a evolutionary trait of the species that are leaf descendants of the node.</li>
        <li><b>Avoiding Over-specificity</b>Over-specific prototypes represents traits that are specific to one or few of the leaf descendant species, rather than representing a common shared trait. In order to avoid over-specificity.</li>
              <ol>
                <li>We introduce a novel <em>over-specificity loss</em> that enforces each prototype to represent a common trait of all leaf descendants.</li>
                <li>We introduce <em>masking module</em> that helps to idenitfy and discard over-specific prototypes that are learned by the model.</li>
              </ol>
        <li><b>Learning Discriminative Traits</b> We introduce <em>discriminative loss</em> to ensure the prototypes represent traits that are absent in the contrasting set of species that have evolved from a different ancestor.</li>
      </ul>

      In addition, we also adopt self-supervised learning of prototypes over the hierarchy to ensure the prototypes are semantically consistent, such that they always represent the same visual concept in different images.

      <!-- We leverage this new modality and introduce two experiments for understanding evolutionary traits inspired by gene-knockout experiments:
      <ol>
        <li><b>Trait Masking:</b>  where we mask out one or more level embedding by substituting it with gaussian noise to verify that the embeddings learned capture hierarchical information.</li>
        <li><b>Trait Swapping:</b> which involves substitution of level-l embedding of a source species with the level-l embedding of a sibling subtree at an equivalent level to visualize the trait differences in the generated images before and after trait swapping that can help us understand the evolutionary traits that branched at a certain level.</li>
      </ol> -->
    </p>

    <!-- <figure style="text-align: center;">
      <img src="images/architecture/architecture-1.png" alt="" loading="lazy" style="height: 300px; width: auto;">
      <figcaption style="margin-top: 10px;">
        Figure 2: Schematic illustration of HComP-Net model architecture.
      </figcaption>
    </figure> -->

    <figure style="text-align: center;">
      <img srcset="" src="images/architecture/architecture-1.png" alt="" loading="lazy">
      <figcaption>
        Figure 2: Schematic illustration of HComP-Net model architecture.
      </figcaption>
    </figure>
    
    
        
    <!-- <h3>Demo</h3>
    <p>Please note that the demo is currently running on free CPU resources provided by Hugging Face, so it may take up to 10 minutes to generate an image. We're working on securing additional resources to speed up the process. Thank you for your patience! </p>
    <script type="module" src="https://gradio.s3-us-west-2.amazonaws.com/4.36.1/gradio.js"></script>
    <gradio-app src="https://mridulk-hier-embed.hf.space/"></gradio-app> -->

    <h2 class="banded" id="evaluation">Experiments</h2>
    <p>
      We evaluate Phylo-Diffusion and show that it achieves high-fidelity at par with the text-to-image and class-conditional diffusion models.
    </p>

    <h3>Classification Performance of HComP-Net</h3>
    <!-- <p><i>Scroll to see all results.</i></p> -->

    <table style="border-collapse: collapse; margin-left: auto; margin-right: auto;">
      <caption>% Accuracy</caption>
      <thead>
        <tr style="border-bottom: 2px solid black;">
          <th style="text-align: left; padding: 8px;">Model</th>
          <th style="text-align: center; padding: 8px;">Hierarchy</th>
          <th style="text-align: center; padding: 8px;">Bird</th>
          <th style="text-align: center; padding: 8px;">Butterfly</th>
          <th style="text-align: center; padding: 8px;">Fish</th>
        </tr>
      </thead>
      <tbody>
        <tr style="border-bottom: 1px solid #ddd;">
          <td style="text-align: left; padding: 8px;">ResNet-50</td>
          <td style="text-align: center; padding: 8px;" rowspan="2">No</td>
          <td style="text-align: center; padding: 8px; font-weight: bold;">74.18</td>
          <td style="text-align: center; padding: 8px;">95.76</td>
          <td style="text-align: center; padding: 8px;">86.63</td>
        </tr>
        <tr style="border-bottom: 1px solid #ddd;">
          <td style="text-align: left; padding: 8px;">INTR</td>
          <td style="text-align: center; padding: 8px;">69.22</td>
          <td style="text-align: center; padding: 8px;">95.53</td>
          <td style="text-align: center; padding: 8px;">86.73</td>
        </tr>
        <tr style="border-bottom: 1px solid #ddd;">
          <td style="text-align: left; padding: 8px;">HPnet</td>
          <td style="text-align: center; padding: 8px;" rowspan="2">Yes</td>
          <td style="text-align: center; padding: 8px;">36.18</td>
          <td style="text-align: center; padding: 8px;">94.69</td>
          <td style="text-align: center; padding: 8px;">77.51</td>
        </tr>
        <tr style="border-bottom: 2px solid black;">
          <td style="text-align: left; padding: 8px;">HComP-Net</td>
          <td style="text-align: center; padding: 8px;">70.01</td>
          <td style="text-align: center; padding: 8px; font-weight: bold;">97.35</td>
          <td style="text-align: center; padding: 8px; font-weight: bold;">90.80</td>
        </tr>
      </tbody>
    </table>

    <h3>Semantic Quality of Prototypes</h3>

    <table style="border-collapse: collapse; margin-left: auto; margin-right: auto;">
      <caption>Part purity of prototypes on Bird dataset.</caption>
      <thead>
        <tr style="border-bottom: 2px solid black;">
          <th style="text-align: left; padding: 8px;">Model</th>
          <th style="text-align: center; padding: 8px;">L<sub>ovsp</sub></th>
          <th style="text-align: center; padding: 8px;">Masking</th>
          <th style="text-align: center; padding: 8px;">Part purity</th>
          <th style="text-align: center; padding: 8px;">% masked</th>
        </tr>
      </thead>
      <tbody>
        <tr style="border-bottom: 1px solid #ddd;">
          <td style="text-align: left; padding: 8px;">HPnet</td>
          <td style="text-align: center; padding: 8px;">-</td>
          <td style="text-align: center; padding: 8px;">-</td>
          <td style="text-align: center; padding: 8px;">0.14 ± 0.09</td>
          <td style="text-align: center; padding: 8px;">-</td>
        </tr>
        <tr style="border-bottom: 1px solid #ddd;">
          <td style="text-align: left; padding: 8px;">HComP-Net</td>
          <td style="text-align: center; padding: 8px;">-</td>
          <td style="text-align: center; padding: 8px;">-</td>
          <td style="text-align: center; padding: 8px;">0.68 ± 0.22</td>
          <td style="text-align: center; padding: 8px;">-</td>
        </tr>
        <tr style="border-bottom: 1px solid #ddd;">
          <td style="text-align: left; padding: 8px;">HComP-Net</td>
          <td style="text-align: center; padding: 8px;">-</td>
          <td style="text-align: center; padding: 8px;">✓</td>
          <td style="text-align: center; padding: 8px;">0.75 ± 0.17</td>
          <td style="text-align: center; padding: 8px;">21.42%</td>
        </tr>
        <tr style="border-bottom: 1px solid #ddd;">
          <td style="text-align: left; padding: 8px;">HComP-Net</td>
          <td style="text-align: center; padding: 8px;">✓</td>
          <td style="text-align: center; padding: 8px;">-</td>
          <td style="text-align: center; padding: 8px;">0.72 ± 0.19</td>
          <td style="text-align: center; padding: 8px;">-</td>
        </tr>
        <tr style="border-bottom: 2px solid black;">
          <td style="text-align: left; padding: 8px;">HComP-Net</td>
          <td style="text-align: center; padding: 8px;">✓</td>
          <td style="text-align: center; padding: 8px;">✓</td>
          <td style="text-align: center; padding: 8px;"><strong>0.77 ± 0.16</strong></td>
          <td style="text-align: center; padding: 8px;">16.53%</td>
        </tr>
      </tbody>
    </table>

    <h3>Prototype Visualizations</h3>

    <figure style="text-align: center;">
      <img srcset="" src="images/Birds_and_Fish-Tree_proto_viz_horizontal_2.png" alt="" loading="lazy" style="max-width: 100%; display: block; margin: 0 auto;">
      <figcaption>
        Figure 3: Visualizing the hierarchy of prototypes discovered by HComP-Net for birds and fishes. *Note that the textual descriptions of the hypothesized traits shown for every prototype are based on human interpretation.
      </figcaption>
    </figure>

    <figure style="text-align: center;">
      <img srcset="" src="images/Shorter Proto Timeline 2 - Western Grebe without INTR (1)-1 cropped.png" alt="" loading="lazy" style="max-width: 100%; display: block; margin: 0 auto;">
      <figcaption>
        Figure 4: We trace the prototypes learned for Western Grebe at three different levels in the phylogenetic tree (corresponding to different periods of time in evolution). Text in blue is the interpretation of common traits of descendants found by HComP-Net at every ancestor node of Western Grebe.
      </figcaption>
    </figure>

    <figure style="text-align: center;">
      <img srcset="" src="images/Butterfly30-Tree_proto_viz_3/Butterfly30-Tree_proto_viz_3-1.png" alt="" loading="lazy" style="max-width: 100%; display: block; margin: 0 auto;">
      <figcaption>
        Figure 5: Visualizing the hierarchy of prototypes discovered by \proposed{} over three levels in the phylogeny of seven species from Butterfly dataset. For each prototype, we visualize one image from each of its leaf descendants.
      </figcaption>
    </figure>
  


    <h2 class="banded">References</h2>
    <p>Please cite our paper if you use our code, data, model or results.</p>
    <pre class="reference">
      @article{manogaran2024you,
        title={What Do You See in Common? Learning Hierarchical Prototypes over Tree-of-Life to Discover Evolutionary Traits},
        author={Manogaran, Harish Babu and Maruf, M and Daw, Arka and Mehrab, Kazi Sajeed and Charpentier, Caleb Patrick and Uyeda, Josef C and Dahdul, Wasila and Thompson, Matthew J and Campolongo, Elizabeth G and Provost, Kaiya L and others},
        journal={arXiv preprint arXiv:2409.02335},
        year={2024}
      }
    </pre>

    <!-- <p>Also consider citing LDM:</p>
    <pre class="reference">@inproceedings{rombach2022high,
      title={High-resolution image synthesis with latent diffusion models},
      author={Rombach, Robin and Blattmann, Andreas and Lorenz, Dominik and Esser, Patrick and Ommer, Bj{\"o}rn},
      booktitle={Proceedings of the IEEE/CVF conference on computer vision and pattern recognition},
      pages={10684--10695},
      year={2022}
    }</pre> -->


    <h2 class="banded">Acknowledgements</h2>
    <p>
      This research is supported by National Science Foundation (NSF) awards for the HDR Imageomics Institute (OAC-<a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2118240">Award #2118240</a>) <a href="https://imageomics.org">Imageomics Institute</a>. We are thankful for the support of computational resources provided by the Advanced Research Computing (ARC) Center at Virginia Tech. This manuscript has been authored by UT-Battelle, LLC, under contract DE-AC05-00OR22725 with the US Department of Energy (DOE). The US government retains, and the publisher, by accepting the article for publication, acknowledges that the US government retains a nonexclusive, paid-up, irrevocable, worldwide license to publish or reproduce the published form of this manuscript or allow others to do so for US government purposes. DOE will provide public access to these results of federally sponsored research in accordance with the DOE Public Access Plan (<a href="https://www.energy.gov/doe-public-access-plan">https://www.energy.gov/doe-public-access-plan</a>).
    </p>
  </main>
  <script>
    const details = document.querySelector("details");
    document.addEventListener("click", function (e) {
      if (!details.contains(e.target)) {
        details.removeAttribute("open");
      }
    });
  </script>
</body>

</html>
