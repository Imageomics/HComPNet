start load env and run python
Resetting modules to system default
Resetting modules to system default
/cm/local/apps/slurm/var/spool/job1526668/slurm_script: line 17: activate: No such file or directory
/home/harishbabu/.conda/envs/hpnet1/bin/python
Log dir:  ./runs/001-CUB-190-imgnet_cnext26_img=224
CUDA device set without id specification
Device used:  cuda with id [0]
Num classes (k) =  190 ['001.Black_footed_Albatross', '002.Laysan_Albatross', '003.Sooty_Albatross', '004.Groove_billed_Ani', '005.Crested_Auklet'] etc.
Number of prototypes:  768
chosen network is convnext
Classification layer initialized with mean 1.0003995895385742
Output shape:  torch.Size([64, 768, 26, 26])

Pretrain Epoch 1 with batch size 128
Pretrain Epoch1:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.1 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch1:   2% 1/44 [00:05<03:55,  5.47s/it, L: 6.091, LA:6.45, LT:1.089, num_scores>0.1:1.0]Pretrain Epoch1:   7% 3/44 [00:08<01:42,  2.50s/it, L: 3.731, LA:5.85, LT:0.629, num_scores>0.1:5.7]Pretrain Epoch1:  11% 5/44 [00:11<01:16,  1.96s/it, L: 2.541, LA:5.88, LT:0.391, num_scores>0.1:1.8]Pretrain Epoch1:  16% 7/44 [00:14<01:04,  1.74s/it, L: 1.900, LA:5.97, LT:0.261, num_scores>0.1:1.8]Pretrain Epoch1:  20% 9/44 [00:17<00:57,  1.63s/it, L: 1.408, LA:5.78, LT:0.166, num_scores>0.1:4.0]Pretrain Epoch1:  25% 11/44 [00:19<00:51,  1.57s/it, L: 1.091, LA:5.82, LT:0.102, num_scores>0.1:8.1]Pretrain Epoch1:  30% 13/44 [00:22<00:47,  1.53s/it, L: 0.773, LA:5.40, LT:0.047, num_scores>0.1:14.7]Pretrain Epoch1:  34% 15/44 [00:25<00:43,  1.50s/it, L: 0.649, LA:5.17, LT:0.027, num_scores>0.1:24.0]Pretrain Epoch1:  39% 17/44 [00:28<00:40,  1.49s/it, L: 0.536, LA:4.56, LT:0.016, num_scores>0.1:32.5]Pretrain Epoch1:  43% 19/44 [00:31<00:36,  1.48s/it, L: 0.420, LA:3.61, LT:0.012, num_scores>0.1:43.3]Pretrain Epoch1:  48% 21/44 [00:34<00:33,  1.47s/it, L: 0.377, LA:3.32, LT:0.009, num_scores>0.1:49.2]Pretrain Epoch1:  52% 23/44 [00:37<00:30,  1.47s/it, L: 0.340, LA:3.11, LT:0.006, num_scores>0.1:55.0]Pretrain Epoch1:  57% 25/44 [00:40<00:27,  1.46s/it, L: 0.303, LA:2.86, LT:0.003, num_scores>0.1:61.2]Pretrain Epoch1:  61% 27/44 [00:43<00:24,  1.46s/it, L: 0.238, LA:2.24, LT:0.003, num_scores>0.1:63.7]Pretrain Epoch1:  66% 29/44 [00:46<00:21,  1.46s/it, L: 0.263, LA:2.46, LT:0.003, num_scores>0.1:61.2]Pretrain Epoch1:  70% 31/44 [00:49<00:18,  1.46s/it, L: 0.265, LA:2.51, LT:0.003, num_scores>0.1:65.3]Pretrain Epoch1:  75% 33/44 [00:51<00:15,  1.45s/it, L: 0.224, LA:2.12, LT:0.002, num_scores>0.1:67.1]Pretrain Epoch1:  80% 35/44 [00:54<00:13,  1.45s/it, L: 0.212, LA:2.03, LT:0.002, num_scores>0.1:70.5]Pretrain Epoch1:  84% 37/44 [00:57<00:10,  1.45s/it, L: 0.194, LA:1.86, LT:0.002, num_scores>0.1:67.6]Pretrain Epoch1:  89% 39/44 [01:00<00:07,  1.45s/it, L: 0.198, LA:1.88, LT:0.002, num_scores>0.1:67.4]Pretrain Epoch1:  93% 41/44 [01:03<00:04,  1.45s/it, L: 0.248, LA:2.39, LT:0.002, num_scores>0.1:69.3]Pretrain Epoch1:  98% 43/44 [01:06<00:01,  1.45s/it, L: 0.270, LA:2.61, LT:0.002, num_scores>0.1:73.1]Pretrain Epoch1: 100% 44/44 [01:07<00:00,  1.55s/it, L: 0.209, LA:2.05, LT:0.001, num_scores>0.1:78.4]
Pretrain Epoch 2 with batch size 128

Pretrain Epoch2:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.2 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch2:   2% 1/44 [00:02<01:53,  2.63s/it, L: 0.407, LA:1.98, LT:0.002, num_scores>0.1:71.3]Pretrain Epoch2:   7% 3/44 [00:05<01:13,  1.79s/it, L: 0.333, LA:1.60, LT:0.003, num_scores>0.1:66.0]Pretrain Epoch2:  11% 5/44 [00:08<01:03,  1.64s/it, L: 0.381, LA:1.86, LT:0.002, num_scores>0.1:71.0]Pretrain Epoch2:  16% 7/44 [00:11<00:57,  1.56s/it, L: 0.396, LA:1.91, LT:0.003, num_scores>0.1:63.1]Pretrain Epoch2:  20% 9/44 [00:14<00:54,  1.56s/it, L: 0.366, LA:1.77, LT:0.003, num_scores>0.1:67.0]Pretrain Epoch2:  25% 11/44 [00:17<00:50,  1.52s/it, L: 0.272, LA:1.31, LT:0.002, num_scores>0.1:68.4]Pretrain Epoch2:  30% 13/44 [00:20<00:46,  1.50s/it, L: 0.354, LA:1.70, LT:0.003, num_scores>0.1:64.0]Pretrain Epoch2:  34% 15/44 [00:23<00:42,  1.48s/it, L: 0.336, LA:1.64, LT:0.002, num_scores>0.1:77.2]Pretrain Epoch2:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.344, LA:1.61, LT:0.004, num_scores>0.1:62.8]Pretrain Epoch2:  43% 19/44 [00:29<00:36,  1.46s/it, L: 0.318, LA:1.55, LT:0.002, num_scores>0.1:76.8]Pretrain Epoch2:  48% 21/44 [00:32<00:33,  1.46s/it, L: 0.302, LA:1.43, LT:0.003, num_scores>0.1:73.3]Pretrain Epoch2:  52% 23/44 [00:34<00:30,  1.46s/it, L: 0.335, LA:1.64, LT:0.001, num_scores>0.1:77.2]Pretrain Epoch2:  57% 25/44 [00:37<00:27,  1.46s/it, L: 0.316, LA:1.52, LT:0.002, num_scores>0.1:74.9]Pretrain Epoch2:  61% 27/44 [00:40<00:24,  1.46s/it, L: 0.339, LA:1.64, LT:0.002, num_scores>0.1:79.4]Pretrain Epoch2:  66% 29/44 [00:43<00:21,  1.45s/it, L: 0.271, LA:1.31, LT:0.002, num_scores>0.1:75.9]Pretrain Epoch2:  70% 31/44 [00:46<00:18,  1.45s/it, L: 0.355, LA:1.71, LT:0.003, num_scores>0.1:67.9]Pretrain Epoch2:  75% 33/44 [00:49<00:15,  1.45s/it, L: 0.275, LA:1.34, LT:0.001, num_scores>0.1:78.2]Pretrain Epoch2:  80% 35/44 [00:52<00:13,  1.46s/it, L: 0.316, LA:1.47, LT:0.004, num_scores>0.1:66.5]Pretrain Epoch2:  84% 37/44 [00:55<00:10,  1.46s/it, L: 0.292, LA:1.43, LT:0.001, num_scores>0.1:85.7]Pretrain Epoch2:  89% 39/44 [00:58<00:07,  1.46s/it, L: 0.333, LA:1.58, LT:0.003, num_scores>0.1:69.4]Pretrain Epoch2:  93% 41/44 [01:01<00:04,  1.47s/it, L: 0.261, LA:1.25, LT:0.002, num_scores>0.1:73.9]Pretrain Epoch2:  98% 43/44 [01:04<00:01,  1.47s/it, L: 0.224, LA:1.07, LT:0.002, num_scores>0.1:78.7]Pretrain Epoch2: 100% 44/44 [01:05<00:00,  1.49s/it, L: 0.252, LA:1.19, LT:0.003, num_scores>0.1:71.3]
Pretrain Epoch 3 with batch size 128

Pretrain Epoch3:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.3 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch3:   2% 1/44 [00:02<02:03,  2.88s/it, L: 0.421, LA:1.37, LT:0.002, num_scores>0.1:78.3]Pretrain Epoch3:   7% 3/44 [00:05<01:14,  1.82s/it, L: 0.385, LA:1.15, LT:0.008, num_scores>0.1:61.3]Pretrain Epoch3:  11% 5/44 [00:08<01:03,  1.64s/it, L: 0.368, LA:1.21, LT:0.001, num_scores>0.1:99.1]Pretrain Epoch3:  16% 7/44 [00:11<00:57,  1.56s/it, L: 0.315, LA:0.92, LT:0.008, num_scores>0.1:68.7]Pretrain Epoch3:  20% 9/44 [00:14<00:54,  1.55s/it, L: 0.389, LA:1.24, LT:0.003, num_scores>0.1:74.8]Pretrain Epoch3:  25% 11/44 [00:17<00:49,  1.51s/it, L: 0.325, LA:1.01, LT:0.004, num_scores>0.1:70.9]Pretrain Epoch3:  30% 13/44 [00:20<00:46,  1.49s/it, L: 0.288, LA:0.89, LT:0.004, num_scores>0.1:74.8]Pretrain Epoch3:  34% 15/44 [00:23<00:42,  1.48s/it, L: 0.244, LA:0.75, LT:0.004, num_scores>0.1:76.2]Pretrain Epoch3:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.254, LA:0.80, LT:0.003, num_scores>0.1:75.4]Pretrain Epoch3:  43% 19/44 [00:29<00:36,  1.47s/it, L: 0.197, LA:0.60, LT:0.003, num_scores>0.1:76.9]Pretrain Epoch3:  48% 21/44 [00:32<00:33,  1.46s/it, L: 0.202, LA:0.61, LT:0.004, num_scores>0.1:75.1]Pretrain Epoch3:  52% 23/44 [00:34<00:30,  1.46s/it, L: 0.201, LA:0.59, LT:0.005, num_scores>0.1:72.6]Pretrain Epoch3:  57% 25/44 [00:37<00:27,  1.46s/it, L: 0.213, LA:0.67, LT:0.002, num_scores>0.1:80.6]Pretrain Epoch3:  61% 27/44 [00:40<00:24,  1.46s/it, L: 0.220, LA:0.67, LT:0.004, num_scores>0.1:75.2]Pretrain Epoch3:  66% 29/44 [00:43<00:21,  1.46s/it, L: 0.175, LA:0.51, LT:0.004, num_scores>0.1:71.3]Pretrain Epoch3:  70% 31/44 [00:46<00:18,  1.45s/it, L: 0.213, LA:0.65, LT:0.003, num_scores>0.1:81.7]Pretrain Epoch3:  75% 33/44 [00:49<00:16,  1.46s/it, L: 0.185, LA:0.56, LT:0.004, num_scores>0.1:76.3]Pretrain Epoch3:  80% 35/44 [00:52<00:13,  1.46s/it, L: 0.176, LA:0.52, LT:0.004, num_scores>0.1:77.3]Pretrain Epoch3:  84% 37/44 [00:55<00:10,  1.46s/it, L: 0.197, LA:0.61, LT:0.003, num_scores>0.1:80.0]Pretrain Epoch3:  89% 39/44 [00:58<00:07,  1.46s/it, L: 0.236, LA:0.76, LT:0.002, num_scores>0.1:88.2]Pretrain Epoch3:  93% 41/44 [01:01<00:04,  1.46s/it, L: 0.183, LA:0.56, LT:0.003, num_scores>0.1:86.7]Pretrain Epoch3:  98% 43/44 [01:04<00:01,  1.46s/it, L: 0.208, LA:0.64, LT:0.003, num_scores>0.1:80.7]Pretrain Epoch3: 100% 44/44 [01:05<00:00,  1.49s/it, L: 0.192, LA:0.61, LT:0.002, num_scores>0.1:95.8]
Pretrain Epoch 4 with batch size 128

Pretrain Epoch4:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.4 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch4:   2% 1/44 [00:02<01:52,  2.61s/it, L: 0.237, LA:0.56, LT:0.003, num_scores>0.1:91.2]Pretrain Epoch4:   7% 3/44 [00:05<01:14,  1.82s/it, L: 0.267, LA:0.59, LT:0.006, num_scores>0.1:75.6]Pretrain Epoch4:  11% 5/44 [00:08<01:03,  1.63s/it, L: 0.222, LA:0.52, LT:0.003, num_scores>0.1:82.3]Pretrain Epoch4:  16% 7/44 [00:11<00:57,  1.56s/it, L: 0.232, LA:0.49, LT:0.007, num_scores>0.1:70.8]Pretrain Epoch4:  20% 9/44 [00:14<00:53,  1.52s/it, L: 0.235, LA:0.56, LT:0.002, num_scores>0.1:89.4]Pretrain Epoch4:  25% 11/44 [00:17<00:50,  1.52s/it, L: 0.266, LA:0.57, LT:0.008, num_scores>0.1:71.5]Pretrain Epoch4:  30% 13/44 [00:20<00:46,  1.50s/it, L: 0.239, LA:0.57, LT:0.002, num_scores>0.1:89.9]Pretrain Epoch4:  34% 15/44 [00:23<00:43,  1.48s/it, L: 0.205, LA:0.45, LT:0.005, num_scores>0.1:78.1]Pretrain Epoch4:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.229, LA:0.53, LT:0.003, num_scores>0.1:77.7]Pretrain Epoch4:  43% 19/44 [00:29<00:36,  1.47s/it, L: 0.168, LA:0.39, LT:0.003, num_scores>0.1:76.7]Pretrain Epoch4:  48% 21/44 [00:32<00:33,  1.46s/it, L: 0.209, LA:0.49, LT:0.002, num_scores>0.1:77.0]Pretrain Epoch4:  52% 23/44 [00:34<00:30,  1.46s/it, L: 0.201, LA:0.46, LT:0.003, num_scores>0.1:75.9]Pretrain Epoch4:  57% 25/44 [00:37<00:27,  1.46s/it, L: 0.230, LA:0.50, LT:0.006, num_scores>0.1:72.1]Pretrain Epoch4:  61% 27/44 [00:40<00:24,  1.45s/it, L: 0.231, LA:0.55, LT:0.002, num_scores>0.1:82.4]Pretrain Epoch4:  66% 29/44 [00:43<00:21,  1.46s/it, L: 0.233, LA:0.54, LT:0.003, num_scores>0.1:76.3]Pretrain Epoch4:  70% 31/44 [00:46<00:18,  1.46s/it, L: 0.203, LA:0.48, LT:0.002, num_scores>0.1:87.7]Pretrain Epoch4:  75% 33/44 [00:49<00:16,  1.46s/it, L: 0.211, LA:0.48, LT:0.004, num_scores>0.1:77.6]Pretrain Epoch4:  80% 35/44 [00:52<00:13,  1.47s/it, L: 0.222, LA:0.52, LT:0.002, num_scores>0.1:78.2]Pretrain Epoch4:  84% 37/44 [00:55<00:10,  1.47s/it, L: 0.203, LA:0.46, LT:0.003, num_scores>0.1:72.4]Pretrain Epoch4:  89% 39/44 [00:58<00:07,  1.47s/it, L: 0.191, LA:0.45, LT:0.002, num_scores>0.1:79.6]Pretrain Epoch4:  93% 41/44 [01:01<00:04,  1.47s/it, L: 0.165, LA:0.38, LT:0.002, num_scores>0.1:75.4]Pretrain Epoch4:  98% 43/44 [01:04<00:01,  1.47s/it, L: 0.159, LA:0.35, LT:0.004, num_scores>0.1:70.9]Pretrain Epoch4: 100% 44/44 [01:05<00:00,  1.49s/it, L: 0.158, LA:0.36, LT:0.003, num_scores>0.1:75.3]
Pretrain Epoch 5 with batch size 128

Pretrain Epoch5:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.5 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch5:   2% 1/44 [00:02<02:03,  2.87s/it, L: 0.172, LA:0.33, LT:0.002, num_scores>0.1:77.8]Pretrain Epoch5:   7% 3/44 [00:05<01:14,  1.82s/it, L: 0.206, LA:0.31, LT:0.010, num_scores>0.1:59.6]Pretrain Epoch5:  11% 5/44 [00:08<01:03,  1.63s/it, L: 0.322, LA:0.64, LT:0.000, num_scores>0.1:126.1]Pretrain Epoch5:  16% 7/44 [00:11<00:57,  1.56s/it, L: 0.250, LA:0.46, LT:0.004, num_scores>0.1:82.0] Pretrain Epoch5:  20% 9/44 [00:14<00:53,  1.52s/it, L: 0.260, LA:0.51, LT:0.001, num_scores>0.1:94.2]Pretrain Epoch5:  25% 11/44 [00:17<00:49,  1.51s/it, L: 0.283, LA:0.54, LT:0.002, num_scores>0.1:106.5]Pretrain Epoch5:  30% 13/44 [00:20<00:46,  1.49s/it, L: 0.283, LA:0.48, LT:0.009, num_scores>0.1:72.5] Pretrain Epoch5:  34% 15/44 [00:23<00:42,  1.48s/it, L: 0.276, LA:0.52, LT:0.003, num_scores>0.1:82.8]Pretrain Epoch5:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.251, LA:0.48, LT:0.002, num_scores>0.1:89.5]Pretrain Epoch5:  43% 19/44 [00:29<00:36,  1.47s/it, L: 0.271, LA:0.48, LT:0.006, num_scores>0.1:75.2]Pretrain Epoch5:  48% 21/44 [00:32<00:33,  1.46s/it, L: 0.206, LA:0.38, LT:0.003, num_scores>0.1:81.6]Pretrain Epoch5:  52% 23/44 [00:34<00:30,  1.46s/it, L: 0.236, LA:0.45, LT:0.002, num_scores>0.1:84.0]Pretrain Epoch5:  57% 25/44 [00:37<00:27,  1.46s/it, L: 0.253, LA:0.47, LT:0.004, num_scores>0.1:75.9]Pretrain Epoch5:  61% 27/44 [00:40<00:24,  1.46s/it, L: 0.230, LA:0.43, LT:0.003, num_scores>0.1:77.9]Pretrain Epoch5:  66% 29/44 [00:43<00:21,  1.46s/it, L: 0.209, LA:0.39, LT:0.003, num_scores>0.1:76.6]Pretrain Epoch5:  70% 31/44 [00:46<00:19,  1.46s/it, L: 0.211, LA:0.36, LT:0.006, num_scores>0.1:65.7]Pretrain Epoch5:  75% 33/44 [00:49<00:16,  1.46s/it, L: 0.179, LA:0.33, LT:0.003, num_scores>0.1:73.3]Pretrain Epoch5:  80% 35/44 [00:52<00:13,  1.47s/it, L: 0.214, LA:0.40, LT:0.003, num_scores>0.1:74.5]Pretrain Epoch5:  84% 37/44 [00:55<00:10,  1.47s/it, L: 0.234, LA:0.43, LT:0.004, num_scores>0.1:69.8]Pretrain Epoch5:  89% 39/44 [00:58<00:07,  1.47s/it, L: 0.180, LA:0.34, LT:0.002, num_scores>0.1:73.2]Pretrain Epoch5:  93% 41/44 [01:01<00:04,  1.47s/it, L: 0.193, LA:0.35, LT:0.003, num_scores>0.1:69.4]Pretrain Epoch5:  98% 43/44 [01:04<00:01,  1.47s/it, L: 0.189, LA:0.35, LT:0.003, num_scores>0.1:71.0]Pretrain Epoch5: 100% 44/44 [01:05<00:00,  1.50s/it, L: 0.226, LA:0.42, LT:0.004, num_scores>0.1:68.2]
Pretrain Epoch 6 with batch size 128

Pretrain Epoch6:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.6 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch6:   2% 1/44 [00:02<02:05,  2.91s/it, L: 0.184, LA:0.29, LT:0.002, num_scores>0.1:75.6]Pretrain Epoch6:   7% 3/44 [00:05<01:15,  1.83s/it, L: 0.222, LA:0.34, LT:0.004, num_scores>0.1:70.2]Pretrain Epoch6:  11% 5/44 [00:08<01:03,  1.64s/it, L: 0.191, LA:0.29, LT:0.004, num_scores>0.1:68.7]Pretrain Epoch6:  16% 7/44 [00:11<00:57,  1.56s/it, L: 0.190, LA:0.30, LT:0.002, num_scores>0.1:76.0]Pretrain Epoch6:  20% 9/44 [00:14<00:53,  1.52s/it, L: 0.166, LA:0.24, LT:0.004, num_scores>0.1:64.7]Pretrain Epoch6:  25% 11/44 [00:17<00:50,  1.52s/it, L: 0.232, LA:0.37, LT:0.002, num_scores>0.1:75.2]Pretrain Epoch6:  30% 13/44 [00:20<00:46,  1.50s/it, L: 0.212, LA:0.34, LT:0.002, num_scores>0.1:76.4]Pretrain Epoch6:  34% 15/44 [00:23<00:42,  1.48s/it, L: 0.214, LA:0.31, LT:0.005, num_scores>0.1:65.5]Pretrain Epoch6:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.197, LA:0.30, LT:0.003, num_scores>0.1:72.2]Pretrain Epoch6:  43% 19/44 [00:29<00:36,  1.47s/it, L: 0.177, LA:0.27, LT:0.003, num_scores>0.1:72.6]Pretrain Epoch6:  48% 21/44 [00:32<00:33,  1.46s/it, L: 0.219, LA:0.33, LT:0.004, num_scores>0.1:68.7]Pretrain Epoch6:  52% 23/44 [00:34<00:30,  1.46s/it, L: 0.195, LA:0.31, LT:0.002, num_scores>0.1:72.8]Pretrain Epoch6:  57% 25/44 [00:37<00:27,  1.46s/it, L: 0.151, LA:0.22, LT:0.004, num_scores>0.1:66.2]Pretrain Epoch6:  61% 27/44 [00:40<00:24,  1.46s/it, L: 0.186, LA:0.26, LT:0.006, num_scores>0.1:64.6]Pretrain Epoch6:  66% 29/44 [00:43<00:21,  1.46s/it, L: 0.184, LA:0.28, LT:0.003, num_scores>0.1:80.7]Pretrain Epoch6:  70% 31/44 [00:46<00:19,  1.46s/it, L: 0.211, LA:0.32, LT:0.003, num_scores>0.1:68.7]Pretrain Epoch6:  75% 33/44 [00:49<00:16,  1.46s/it, L: 0.191, LA:0.29, LT:0.003, num_scores>0.1:67.8]Pretrain Epoch6:  80% 35/44 [00:52<00:13,  1.47s/it, L: 0.197, LA:0.31, LT:0.002, num_scores>0.1:75.3]Pretrain Epoch6:  84% 37/44 [00:55<00:10,  1.47s/it, L: 0.175, LA:0.26, LT:0.004, num_scores>0.1:70.0]Pretrain Epoch6:  89% 39/44 [00:58<00:07,  1.47s/it, L: 0.174, LA:0.27, LT:0.002, num_scores>0.1:70.2]Pretrain Epoch6:  93% 41/44 [01:01<00:04,  1.47s/it, L: 0.193, LA:0.29, LT:0.004, num_scores>0.1:73.0]Pretrain Epoch6:  98% 43/44 [01:04<00:01,  1.47s/it, L: 0.161, LA:0.23, LT:0.005, num_scores>0.1:65.0]Pretrain Epoch6: 100% 44/44 [01:05<00:00,  1.50s/it, L: 0.167, LA:0.26, LT:0.002, num_scores>0.1:74.5]
Pretrain Epoch 7 with batch size 128

Pretrain Epoch7:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.7 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch7:   2% 1/44 [00:02<02:07,  2.96s/it, L: 0.224, LA:0.30, LT:0.003, num_scores>0.1:68.8]Pretrain Epoch7:   7% 3/44 [00:05<01:15,  1.85s/it, L: 0.263, LA:0.36, LT:0.002, num_scores>0.1:71.7]Pretrain Epoch7:  11% 5/44 [00:08<01:04,  1.64s/it, L: 0.192, LA:0.23, LT:0.006, num_scores>0.1:61.0]Pretrain Epoch7:  16% 7/44 [00:11<00:57,  1.56s/it, L: 0.220, LA:0.30, LT:0.002, num_scores>0.1:75.7]Pretrain Epoch7:  20% 9/44 [00:14<00:53,  1.54s/it, L: 0.177, LA:0.22, LT:0.005, num_scores>0.1:63.3]Pretrain Epoch7:  25% 11/44 [00:17<00:49,  1.51s/it, L: 0.192, LA:0.26, LT:0.002, num_scores>0.1:75.3]Pretrain Epoch7:  30% 13/44 [00:20<00:46,  1.49s/it, L: 0.167, LA:0.21, LT:0.004, num_scores>0.1:66.8]Pretrain Epoch7:  34% 15/44 [00:23<00:42,  1.48s/it, L: 0.188, LA:0.24, LT:0.003, num_scores>0.1:68.7]Pretrain Epoch7:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.166, LA:0.20, LT:0.006, num_scores>0.1:59.5]Pretrain Epoch7:  43% 19/44 [00:29<00:36,  1.46s/it, L: 0.215, LA:0.29, LT:0.002, num_scores>0.1:71.9]Pretrain Epoch7:  48% 21/44 [00:32<00:33,  1.46s/it, L: 0.177, LA:0.22, LT:0.004, num_scores>0.1:62.7]Pretrain Epoch7:  52% 23/44 [00:35<00:30,  1.46s/it, L: 0.206, LA:0.27, LT:0.004, num_scores>0.1:65.8]Pretrain Epoch7:  57% 25/44 [00:37<00:27,  1.46s/it, L: 0.183, LA:0.25, LT:0.002, num_scores>0.1:77.6]Pretrain Epoch7:  61% 27/44 [00:40<00:24,  1.45s/it, L: 0.179, LA:0.23, LT:0.004, num_scores>0.1:64.5]Pretrain Epoch7:  66% 29/44 [00:43<00:21,  1.46s/it, L: 0.181, LA:0.25, LT:0.002, num_scores>0.1:74.6]Pretrain Epoch7:  70% 31/44 [00:46<00:19,  1.46s/it, L: 0.162, LA:0.21, LT:0.004, num_scores>0.1:65.8]Pretrain Epoch7:  75% 33/44 [00:49<00:16,  1.46s/it, L: 0.166, LA:0.22, LT:0.003, num_scores>0.1:69.7]Pretrain Epoch7:  80% 35/44 [00:52<00:13,  1.47s/it, L: 0.167, LA:0.21, LT:0.004, num_scores>0.1:63.7]Pretrain Epoch7:  84% 37/44 [00:55<00:10,  1.47s/it, L: 0.176, LA:0.24, LT:0.002, num_scores>0.1:69.1]Pretrain Epoch7:  89% 39/44 [00:58<00:07,  1.47s/it, L: 0.166, LA:0.21, LT:0.003, num_scores>0.1:65.4]Pretrain Epoch7:  93% 41/44 [01:01<00:04,  1.47s/it, L: 0.155, LA:0.20, LT:0.003, num_scores>0.1:66.3]Pretrain Epoch7:  98% 43/44 [01:04<00:01,  1.47s/it, L: 0.174, LA:0.23, LT:0.002, num_scores>0.1:69.0]Pretrain Epoch7: 100% 44/44 [01:05<00:00,  1.50s/it, L: 0.174, LA:0.24, LT:0.001, num_scores>0.1:75.4]
Pretrain Epoch 8 with batch size 128

Pretrain Epoch8:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.8 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch8:   2% 1/44 [00:02<02:07,  2.96s/it, L: 0.195, LA:0.23, LT:0.002, num_scores>0.1:73.6]Pretrain Epoch8:   7% 3/44 [00:05<01:15,  1.84s/it, L: 0.184, LA:0.21, LT:0.004, num_scores>0.1:63.3]Pretrain Epoch8:  11% 5/44 [00:08<01:04,  1.64s/it, L: 0.184, LA:0.21, LT:0.003, num_scores>0.1:65.8]Pretrain Epoch8:  16% 7/44 [00:11<00:57,  1.56s/it, L: 0.177, LA:0.19, LT:0.005, num_scores>0.1:61.0]Pretrain Epoch8:  20% 9/44 [00:14<00:53,  1.54s/it, L: 0.187, LA:0.21, LT:0.003, num_scores>0.1:66.8]Pretrain Epoch8:  25% 11/44 [00:17<00:49,  1.51s/it, L: 0.193, LA:0.22, LT:0.003, num_scores>0.1:67.9]Pretrain Epoch8:  30% 13/44 [00:20<00:46,  1.49s/it, L: 0.172, LA:0.18, LT:0.005, num_scores>0.1:60.4]Pretrain Epoch8:  34% 15/44 [00:23<00:42,  1.48s/it, L: 0.181, LA:0.21, LT:0.002, num_scores>0.1:69.8]Pretrain Epoch8:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.213, LA:0.25, LT:0.002, num_scores>0.1:69.1]Pretrain Epoch8:  43% 19/44 [00:29<00:36,  1.46s/it, L: 0.185, LA:0.21, LT:0.003, num_scores>0.1:67.5]Pretrain Epoch8:  48% 21/44 [00:32<00:33,  1.46s/it, L: 0.182, LA:0.21, LT:0.002, num_scores>0.1:73.5]Pretrain Epoch8:  52% 23/44 [00:35<00:30,  1.46s/it, L: 0.172, LA:0.17, LT:0.007, num_scores>0.1:56.6]Pretrain Epoch8:  57% 25/44 [00:37<00:27,  1.46s/it, L: 0.170, LA:0.20, LT:0.002, num_scores>0.1:68.8]Pretrain Epoch8:  61% 27/44 [00:40<00:24,  1.45s/it, L: 0.208, LA:0.23, LT:0.005, num_scores>0.1:60.6]Pretrain Epoch8:  66% 29/44 [00:43<00:21,  1.45s/it, L: 0.168, LA:0.20, LT:0.002, num_scores>0.1:71.7]Pretrain Epoch8:  70% 31/44 [00:46<00:18,  1.46s/it, L: 0.168, LA:0.18, LT:0.004, num_scores>0.1:60.0]Pretrain Epoch8:  75% 33/44 [00:49<00:16,  1.46s/it, L: 0.167, LA:0.19, LT:0.003, num_scores>0.1:67.0]Pretrain Epoch8:  80% 35/44 [00:52<00:13,  1.46s/it, L: 0.165, LA:0.20, LT:0.002, num_scores>0.1:70.0]Pretrain Epoch8:  84% 37/44 [00:55<00:10,  1.47s/it, L: 0.163, LA:0.18, LT:0.004, num_scores>0.1:59.5]Pretrain Epoch8:  89% 39/44 [00:58<00:07,  1.47s/it, L: 0.167, LA:0.20, LT:0.002, num_scores>0.1:69.0]Pretrain Epoch8:  93% 41/44 [01:01<00:04,  1.47s/it, L: 0.161, LA:0.18, LT:0.003, num_scores>0.1:62.8]Pretrain Epoch8:  98% 43/44 [01:04<00:01,  1.47s/it, L: 0.156, LA:0.17, LT:0.004, num_scores>0.1:61.3]Pretrain Epoch8: 100% 44/44 [01:05<00:00,  1.50s/it, L: 0.159, LA:0.17, LT:0.004, num_scores>0.1:60.2]
Pretrain Epoch 9 with batch size 128

Pretrain Epoch9:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  0.9 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch9:   2% 1/44 [00:02<02:02,  2.86s/it, L: 0.225, LA:0.24, LT:0.002, num_scores>0.1:63.7]Pretrain Epoch9:   7% 3/44 [00:05<01:14,  1.81s/it, L: 0.235, LA:0.24, LT:0.004, num_scores>0.1:62.4]Pretrain Epoch9:  11% 5/44 [00:08<01:03,  1.63s/it, L: 0.174, LA:0.18, LT:0.002, num_scores>0.1:65.8]Pretrain Epoch9:  16% 7/44 [00:11<00:57,  1.55s/it, L: 0.176, LA:0.18, LT:0.002, num_scores>0.1:65.4]Pretrain Epoch9:  20% 9/44 [00:14<00:53,  1.52s/it, L: 0.174, LA:0.17, LT:0.005, num_scores>0.1:58.2]Pretrain Epoch9:  25% 11/44 [00:17<00:49,  1.49s/it, L: 0.173, LA:0.17, LT:0.004, num_scores>0.1:59.4]Pretrain Epoch9:  30% 13/44 [00:20<00:45,  1.48s/it, L: 0.177, LA:0.18, LT:0.004, num_scores>0.1:59.4]Pretrain Epoch9:  34% 15/44 [00:23<00:42,  1.47s/it, L: 0.169, LA:0.18, LT:0.002, num_scores>0.1:65.0]Pretrain Epoch9:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.167, LA:0.16, LT:0.004, num_scores>0.1:57.6]Pretrain Epoch9:  43% 19/44 [00:28<00:36,  1.46s/it, L: 0.167, LA:0.17, LT:0.003, num_scores>0.1:59.8]Pretrain Epoch9:  48% 21/44 [00:31<00:33,  1.46s/it, L: 0.176, LA:0.17, LT:0.004, num_scores>0.1:59.7]Pretrain Epoch9:  52% 23/44 [00:34<00:30,  1.47s/it, L: 0.190, LA:0.20, LT:0.002, num_scores>0.1:66.9]Pretrain Epoch9:  57% 25/44 [00:37<00:27,  1.47s/it, L: 0.170, LA:0.17, LT:0.003, num_scores>0.1:62.9]Pretrain Epoch9:  61% 27/44 [00:40<00:24,  1.47s/it, L: 0.167, LA:0.15, LT:0.006, num_scores>0.1:53.5]Pretrain Epoch9:  66% 29/44 [00:43<00:22,  1.47s/it, L: 0.174, LA:0.17, LT:0.004, num_scores>0.1:57.9]Pretrain Epoch9:  70% 31/44 [00:46<00:19,  1.47s/it, L: 0.175, LA:0.18, LT:0.002, num_scores>0.1:65.3]Pretrain Epoch9:  75% 33/44 [00:49<00:16,  1.47s/it, L: 0.182, LA:0.19, LT:0.003, num_scores>0.1:62.3]Pretrain Epoch9:  80% 35/44 [00:52<00:13,  1.47s/it, L: 0.170, LA:0.17, LT:0.004, num_scores>0.1:60.7]Pretrain Epoch9:  84% 37/44 [00:55<00:10,  1.47s/it, L: 0.211, LA:0.20, LT:0.006, num_scores>0.1:58.0]Pretrain Epoch9:  89% 39/44 [00:58<00:07,  1.47s/it, L: 0.203, LA:0.20, LT:0.004, num_scores>0.1:56.6]Pretrain Epoch9:  93% 41/44 [01:01<00:04,  1.47s/it, L: 0.172, LA:0.18, LT:0.002, num_scores>0.1:64.8]Pretrain Epoch9:  98% 43/44 [01:04<00:01,  1.47s/it, L: 0.171, LA:0.17, LT:0.004, num_scores>0.1:60.8]Pretrain Epoch9: 100% 44/44 [01:05<00:00,  1.50s/it, L: 0.168, LA:0.17, LT:0.003, num_scores>0.1:61.9]
Pretrain Epoch 10 with batch size 128

Pretrain Epoch10:   0% 0/44 [00:00<?, ?it/s]Number of parameters that require gradient:  31
Align weight:  1.0 , U_tanh weight:  5.0 Class weight: 0.0
Pretrain? True Finetune? False
Pretrain Epoch10:   2% 1/44 [00:02<01:55,  2.69s/it, L: 0.195, LA:0.17, LT:0.005, num_scores>0.1:56.4]Pretrain Epoch10:   7% 3/44 [00:05<01:14,  1.81s/it, L: 0.198, LA:0.19, LT:0.002, num_scores>0.1:66.6]Pretrain Epoch10:  11% 5/44 [00:08<01:04,  1.65s/it, L: 0.202, LA:0.19, LT:0.003, num_scores>0.1:63.7]Pretrain Epoch10:  16% 7/44 [00:11<00:57,  1.57s/it, L: 0.184, LA:0.17, LT:0.002, num_scores>0.1:64.1]Pretrain Epoch10:  20% 9/44 [00:14<00:53,  1.52s/it, L: 0.175, LA:0.15, LT:0.005, num_scores>0.1:53.4]Pretrain Epoch10:  25% 11/44 [00:17<00:50,  1.52s/it, L: 0.179, LA:0.15, LT:0.005, num_scores>0.1:54.9]Pretrain Epoch10:  30% 13/44 [00:20<00:46,  1.50s/it, L: 0.236, LA:0.22, LT:0.003, num_scores>0.1:63.3]Pretrain Epoch10:  34% 15/44 [00:23<00:42,  1.48s/it, L: 0.192, LA:0.18, LT:0.003, num_scores>0.1:63.5]Pretrain Epoch10:  39% 17/44 [00:26<00:39,  1.47s/it, L: 0.179, LA:0.17, LT:0.002, num_scores>0.1:63.3]Pretrain Epoch10:  43% 19/44 [00:29<00:36,  1.47s/it, L: 0.184, LA:0.17, LT:0.003, num_scores>0.1:60.8]Pretrain Epoch10:  48% 21/44 [00:32<00:33,  1.46s/it, L: 0.189, LA:0.18, LT:0.002, num_scores>0.1:64.0]Pretrain Epoch10:  52% 23/44 [00:34<00:30,  1.46s/it, L: 0.184, LA:0.17, LT:0.004, num_scores>0.1:60.0]Pretrain Epoch10:  57% 25/44 [00:37<00:27,  1.46s/it, L: 0.183, LA:0.16, LT:0.004, num_scores>0.1:57.7]Pretrain Epoch10:  61% 27/44 [00:40<00:24,  1.45s/it, L: 0.227, LA:0.21, LT:0.004, num_scores>0.1:56.8]Pretrain Epoch10:  66% 29/44 [00:43<00:21,  1.45s/it, L: 0.182, LA:0.17, LT:0.003, num_scores>0.1:59.3]Pretrain Epoch10:  70% 31/44 [00:46<00:18,  1.46s/it, L: 0.188, LA:0.17, LT:0.003, num_scores>0.1:61.6]Pretrain Epoch10:  75% 33/44 [00:49<00:16,  1.46s/it, L: 0.179, LA:0.16, LT:0.003, num_scores>0.1:61.7]Pretrain Epoch10:  80% 35/44 [00:52<00:13,  1.46s/it, L: 0.186, LA:0.17, LT:0.003, num_scores>0.1:61.8]Pretrain Epoch10:  84% 37/44 [00:55<00:10,  1.46s/it, L: 0.229, LA:0.21, LT:0.003, num_scores>0.1:61.0]Pretrain Epoch10:  89% 39/44 [00:58<00:07,  1.46s/it, L: 0.187, LA:0.16, LT:0.005, num_scores>0.1:56.6]Pretrain Epoch10:  93% 41/44 [01:01<00:04,  1.46s/it, L: 0.177, LA:0.16, LT:0.003, num_scores>0.1:59.5]Pretrain Epoch10:  98% 43/44 [01:04<00:01,  1.46s/it, L: 0.187, LA:0.17, LT:0.003, num_scores>0.1:59.7]Pretrain Epoch10: 100% 44/44 [01:05<00:00,  1.49s/it, L: 0.275, LA:0.25, LT:0.004, num_scores>0.1:56.1]Visualizing prototypes for topk...

Collecting topk:   0% 0/5695 [00:00<?, ?it/s]Collecting topk:  10% 569/5695 [00:50<07:31, 11.36it/s]Collecting topk:  10% 569/5695 [01:10<07:31, 11.36it/s]Collecting topk:  20% 1154/5695 [01:40<06:32, 11.56it/s]Collecting topk:  20% 1154/5695 [02:00<06:32, 11.56it/s]Collecting topk:  31% 1739/5695 [02:30<05:40, 11.62it/s]Collecting topk:  31% 1739/5695 [02:50<05:40, 11.62it/s]Collecting topk:  41% 2325/5695 [03:20<04:49, 11.66it/s]Collecting topk:  41% 2325/5695 [03:40<04:49, 11.66it/s]Collecting topk:  51% 2911/5695 [04:10<03:58, 11.68it/s]Collecting topk:  51% 2911/5695 [04:30<03:58, 11.68it/s]Collecting topk:  61% 3497/5695 [05:00<03:08, 11.69it/s]Collecting topk:  61% 3497/5695 [05:20<03:08, 11.69it/s]Collecting topk:  72% 4084/5695 [05:50<02:17, 11.70it/s]Collecting topk:  72% 4084/5695 [06:10<02:17, 11.70it/s]Collecting topk:  82% 4672/5695 [06:40<01:27, 11.72it/s]Collecting topk:  82% 4672/5695 [07:00<01:27, 11.72it/s]Collecting topk:  92% 5261/5695 [07:30<00:36, 11.73it/s]Collecting topk:  92% 5261/5695 [07:50<00:36, 11.73it/s]Collecting topk: 100% 5695/5695 [08:07<00:00, 11.69it/s]26 prototypes do not have any similarity score > 0.1. Will be ignored in visualisation.

Visualizing topk:   0% 0/5695 [00:00<?, ?it/s]> /home/harishbabu/projects/PIPNet/util/vis_pipnet.py(303)get_img_coordinates()
-> if h_idx == softmaxes_shape[1]-1:
(Pdb) Visualizing topk:   0% 0/5695 [00:00<?, ?it/s]

Traceback (most recent call last):
  File "main.py", line 368, in <module>
    run_pipnet(args)
  File "main.py", line 172, in run_pipnet
    topks = visualize_topk(net, projectloader, len(classes), device, 'visualised_pretrained_prototypes_topk', args)
  File "/home/harishbabu/.conda/envs/hpnet1/lib/python3.8/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/harishbabu/projects/PIPNet/util/vis_pipnet.py", line 131, in visualize_topk
    h_coor_min, h_coor_max, w_coor_min, w_coor_max = get_img_coordinates(args.image_size, softmaxes.shape, patchsize, skip, h_idx, w_idx)
  File "/home/harishbabu/projects/PIPNet/util/vis_pipnet.py", line 303, in get_img_coordinates
    if h_idx == softmaxes_shape[1]-1:
  File "/home/harishbabu/projects/PIPNet/util/vis_pipnet.py", line 303, in get_img_coordinates
    if h_idx == softmaxes_shape[1]-1:
  File "/home/harishbabu/.conda/envs/hpnet1/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/harishbabu/.conda/envs/hpnet1/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
